function downloadPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const date = new Date().toLocaleDateString("en-US");
  const total = document.getElementById("total").textContent;

  const logo = new Image();
  logo.src = "https://raw.githubusercontent.com/KhalidMas23/Aquaria-Calculator/8dc0a0fc0875cb830a78b1b9d2eee37c5048348a/AQ_LOGOPACK_RGB-04.png";

  logo.onload = function () {
    doc.addImage(logo, "PNG", 150, 10, 40, 15);

    doc.setFontSize(14);
    doc.setFont(undefined, 'bold');
    doc.text("Aquaria", 20, 15);
    doc.setFontSize(10);
    doc.setFont(undefined, 'normal');
    doc.text("600 Congress Ave, Austin, TX 78701", 20, 21);
    doc.text(`Quote Generated: ${date}`, 20, 27);

    let y = 40;
    const addLine = (label, value) => {
      doc.setFont(undefined, 'normal');
      doc.text(`${label}: ${value}`, 25, y);
      y += 7;
    };

    const addSectionHeader = (title) => {
      doc.setFont(undefined, 'bold');
      doc.setFontSize(12);
      doc.text(title, 20, y);
      y += 5;
      doc.setDrawColor(180);
      doc.line(20, y, 190, y);
      y += 5;
    };

    addSectionHeader("Product");
    addLine("Hydropack Model", document.getElementById("model").selectedOptions[0]?.text || "");
    addLine("Unit Only", document.getElementById("unitOnly").checked ? "Yes" : "No");
    addLine("Concrete Pad (unit)", document.getElementById("unitPad").checked ? "Yes" : "No");
    addLine("Mobility Assistance", document.getElementById("mobility").checked ? "Yes" : "No");

    addSectionHeader("Add-ons");
    addLine("Panel Upgrade", document.getElementById("panelUpgrade")?.checked ? "Yes" : "No");

    addSectionHeader("Additional Filters");
    addLine("Filter", document.getElementById("filter").selectedOptions[0]?.text || "");
    addLine("Pump", document.getElementById("pump").selectedOptions[0]?.text || "");
    addLine("Tank Sensor", document.getElementById("sensor").selectedOptions[0]?.text || "");

    addSectionHeader("Shipping / Handling");
    addLine("Tank", document.getElementById("tank").selectedOptions[0]?.text || "");
    addLine("Delivery City", document.getElementById("city").selectedOptions[0]?.text || "");
    addLine("Connection Type", document.getElementById("connection").selectedOptions[0]?.text || "");

    addSectionHeader("Additional Services");
    addLine("Tank Concrete Pad", document.getElementById("tankPad").checked ? "Yes" : "No");
    addLine("Trenching Type", document.getElementById("trenchingType").selectedOptions[0]?.text || "");
    addLine("Trenching Distance (ft)", document.getElementById("trenchDistance").value);

    addSectionHeader("Admin & Processing Fee");
    addLine("Flat Fee", "$500.00");

    addSectionHeader("Sales Tax");
    const salesTax = calculateTotal() - (calculateTotal() / (1 + 0.0825));
    addLine("8.25% Tax (included in total)", `$${salesTax.toFixed(2)}`);

    addSectionHeader("Total");
    doc.setFont(undefined, 'bold');
    doc.setFontSize(14);
    doc.text(`Total Estimate: $${total}`, 20, y);

    doc.setFontSize(10);
    doc.setFont(undefined, 'normal');
    doc.text("Thank you for your interest in Aquaria. This quote is valid for 30 days.", 20, 285);

    doc.save("Hydropack_Quote.pdf");
  };
}
